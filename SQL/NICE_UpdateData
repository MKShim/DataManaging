show global variables like 'local_infile';
set global local_infile=true;

create table numble.closed_infor (
BIZ_NO	VARCHAR(10)	DEFAULT NULL,
CMP_PFIX_NM	VARCHAR(64)	DEFAULT NULL,
CMP_NM	VARCHAR(128)	DEFAULT NULL,
CMP_SFIX_NM	VARCHAR(64)	DEFAULT NULL,
CMP_ENM	VARCHAR(256)	DEFAULT NULL,
BZ_TYP	VARCHAR(3)	DEFAULT NULL,
CMP_SCL	VARCHAR(3)	DEFAULT NULL,
PBCO_GB	VARCHAR(3)	DEFAULT NULL,
PSN_CORP_GB	VARCHAR(3)	DEFAULT NULL,
HDOF_BR_GB	VARCHAR(3)	DEFAULT NULL,
FR_IVST_CORP_YN	VARCHAR(1)	DEFAULT NULL,
VENT_YN	VARCHAR(1)	DEFAULT NULL,
LIST_CD	VARCHAR(10)	DEFAULT NULL,
IND_CD_ORDR	INT(5)	DEFAULT NULL,
IND_CD1	VARCHAR(6)	DEFAULT NULL,
IND_CD2	VARCHAR(6)	DEFAULT NULL,
IND_CD3	VARCHAR(6)	DEFAULT NULL,
PB_ORG_TYP	VARCHAR(3)	DEFAULT NULL,
MDSCO_PRTC_YN	VARCHAR(1)	DEFAULT NULL,
HDOF_CMP_CD	INT(10)	DEFAULT NULL,
ESTB_DATE	VARCHAR(8)	DEFAULT NULL,
ESTB_GB	VARCHAR(3)	DEFAULT NULL,
LIST_DATE	VARCHAR(8)	DEFAULT NULL,
MN_BIZ_CONT	VARCHAR(256)	DEFAULT NULL,
NATN_NM	VARCHAR(64)	DEFAULT NULL,
HOMEPAGE_URL	VARCHAR(128)	DEFAULT NULL,
CEO_NM	VARCHAR(128)	DEFAULT NULL,
EMP_CNT	INT(10)	DEFAULT NULL
);

load data local infile '/Users/minkyoung/Documents/data/numble/closed_infor.csv' 
into table numble.closed_infor 
CHARACTER SET 'utf8'
FIELDS 
	TERMINATED BY ','
	IGNORE 1 LINES;

#drop table numble.closed_infor; 
#drop table numble.closed_history; 


create table numble.closed_history (
BIZ_NO	VARCHAR(10)	DEFAULT NULL,
END_DATE	VARCHAR(8)	DEFAULT NULL,
STRT_DATE	VARCHAR(8)	DEFAULT NULL,
CLSBZ_GB	VARCHAR(3)	DEFAULT NULL,
STAT_OCR_DATE	VARCHAR(8)	DEFAULT NULL
);

load data local infile '/Users/minkyoung/Documents/data/numble/closed_history.csv' 
into table numble.closed_history 
CHARACTER SET 'utf8'
FIELDS 
	TERMINATED BY ','
	IGNORE 1 LINES;


create table numble.finance_data (
BIZ_NO	VARCHAR(10)	DEFAULT NULL,
STT_YR	VARCHAR(8)	DEFAULT NULL,
CurrentAssets	INT(10)	DEFAULT NULL,
TradeReceivables	INT(10)	DEFAULT NULL,
NonCurrentAssets	INT(10)	DEFAULT NULL,
TangibleAssets	INT(10)	DEFAULT NULL,
TotalAssets	INT(10)	DEFAULT NULL,
CurrentLiabilities	INT(10)	DEFAULT NULL,
NonCurrentLiabilitie	INT(10)	DEFAULT NULL,
TotalLiabilities	INT(10)	DEFAULT NULL,
CapitalStock	INT(10)	DEFAULT NULL,
RetainedEarnings	INT(10)	DEFAULT NULL,
TotStockholderEquity	INT(10)	DEFAULT NULL,
Sales	INT(10)	DEFAULT NULL,
SellAdminExpenses	INT(10)	DEFAULT NULL,
OperatingIncome	INT(10)	DEFAULT NULL,
NetIncomeBeforeTaxes	INT(10)	DEFAULT NULL,
IncomeTaxes	INT(10)	DEFAULT NULL,
NetIncome	INT(10)	DEFAULT NULL,
NetcompincometoSales	float(10)	DEFAULT NULL,
RetainEarntoTotAsset	float(10)	DEFAULT NULL,
RetainEarntoPaidCap	float(10)	DEFAULT NULL,
GrossIncometoSales	float(10)	DEFAULT NULL,
OperateIncometoSales	float(10)	DEFAULT NULL,
NetIncometoSales	float(10)	DEFAULT NULL,
TotExpentoTotRev	float(10)	DEFAULT NULL,
OrdinaryExpentoRev	float(10)	DEFAULT NULL,
SellNGenAdminExpen	float(10)	DEFAULT NULL,
FinExpentoSales	float(10)	DEFAULT NULL,
FinExpentoLiab	float(10)	DEFAULT NULL,
FinExpentoTotExpen	float(10)	DEFAULT NULL,
DebttoEquityRatio	float(10)	DEFAULT NULL,
TotBorrowNDebPayable	float(10)	DEFAULT NULL,
StockEquityTotAsset	float(10)	DEFAULT NULL,
NetWorkCapitTotAsset	float(10)	DEFAULT NULL,
CurrentLiabRatio	float(10)	DEFAULT NULL,
LongTermLiabTotRatio	float(10)	DEFAULT NULL,
TotLiabtoSales	float(10)	DEFAULT NULL,
TotalAssetsTurnover	float(10)	DEFAULT NULL,
InventoriesTurnover	float(10)	DEFAULT NULL,
TradeReceivTurnover	float(10)	DEFAULT NULL,
TradePayabTurnover	float(10)	DEFAULT NULL,
OtherReceivables	INT(10)	DEFAULT NULL,
CostOfSales	INT(10)	DEFAULT NULL,
IntangibleAssets	INT(10)	DEFAULT NULL,
Inventories	INT(10)	DEFAULT NULL
);

load data local infile '/Users/minkyoung/Documents/data/numble/finance_data.csv' 
into table numble.finance_data 
CHARACTER SET 'utf8'
FIELDS 
	TERMINATED BY ','
	IGNORE 1 LINES;

#select * from finance_data;
#drop table numble.active_infor; 
#select * from active_infor;

create table numble.active_infor (		
BIZ_NO	VARCHAR(10)	DEFAULT NULL,
CMP_PFIX_NM	VARCHAR(64)	DEFAULT NULL,
CMP_NM	VARCHAR(128)	DEFAULT NULL,
CMP_NM1	VARCHAR(128)	DEFAULT NULL,
CMP_SFIX_NM	VARCHAR(64)	DEFAULT NULL,
CMP_ENM	VARCHAR(256)	DEFAULT NULL,
BZ_TYP	VARCHAR(3)	DEFAULT NULL,
CMP_TYP	VARCHAR(3)	DEFAULT NULL,
CMP_SCL	VARCHAR(3)	DEFAULT NULL,
PBCO_GB	VARCHAR(3)	DEFAULT NULL,
PSN_CORP_GB	VARCHAR(3)	DEFAULT NULL,
HDOF_BR_GB	VARCHAR(3)	DEFAULT NULL,
FR_IVST_CORP_YN	VARCHAR(1)	DEFAULT NULL,
VENT_YN	VARCHAR(1)	DEFAULT NULL,
LIST_CD	VARCHAR(10)	DEFAULT NULL,
IND_CD_ORDR	INT(5)	DEFAULT NULL,
IND_CD1	VARCHAR(6)	DEFAULT NULL,
IND_CD2	VARCHAR(6)	DEFAULT NULL,
IND_CD3	VARCHAR(6)	DEFAULT NULL,
PB_ORG_TYP	VARCHAR(3)	DEFAULT NULL,
MDSCO_PRTC_YN	VARCHAR(1)	DEFAULT NULL,
TAXN_TYP	VARCHAR(1)	DEFAULT NULL,
HDOF_CMP_CD	INT(10)	DEFAULT NULL,
ESTB_DATE	VARCHAR(8)	DEFAULT NULL,
ESTB_GB	VARCHAR(3)	DEFAULT NULL,
LIST_DATE	VARCHAR(8)	DEFAULT NULL,
MN_BIZ_CONT	VARCHAR(256)	DEFAULT NULL,
NATN_NM	VARCHAR(64)	DEFAULT NULL,
HOMEPAGE_URL	VARCHAR(128)	DEFAULT NULL,
CEO_NM	VARCHAR(128)	DEFAULT NULL,
EMP_CNT	INT(10)	DEFAULT NULL
);		
		
load data local infile '/Users/minkyoung/Documents/data/numble/active_infor.csv' 		
into table numble.active_infor 		
CHARACTER SET 'utf8'		
FIELDS 		
	TERMINATED BY ','	
	IGNORE 1 LINES;	
		
create table numble.active_history (		
BIZ_NO	VARCHAR(10)	DEFAULT NULL,
END_DATE	VARCHAR(8)	DEFAULT NULL,
STRT_DATE	VARCHAR(8)	DEFAULT NULL,
CLSBZ_GB	VARCHAR(3)	DEFAULT NULL,
STAT_OCR_DATE	VARCHAR(8)	DEFAULT NULL
);		
		
load data local infile '/Users/minkyoung/Documents/data/numble/active_history.csv' 		
into table numble.active_history 		
CHARACTER SET 'utf8'		
FIELDS 		
	TERMINATED BY ','	
	IGNORE 1 LINES;	
				
#select * from numble.active_history;
		
create table numble.BigActive_infor (		
BIZ_NO	VARCHAR(10)	DEFAULT NULL,
CMP_PFIX_NM	VARCHAR(64)	DEFAULT NULL,
CMP_NM1	VARCHAR(128)	DEFAULT NULL,
CMP_SFIX_NM	VARCHAR(64)	DEFAULT NULL,
CMP_ENM	VARCHAR(256)	DEFAULT NULL,
BZ_TYP	VARCHAR(3)	DEFAULT NULL,
CMP_SCL	VARCHAR(3)	DEFAULT NULL,
PBCO_GB	VARCHAR(3)	DEFAULT NULL,
PSN_CORP_GB	VARCHAR(3)	DEFAULT NULL,
HDOF_BR_GB	VARCHAR(3)	DEFAULT NULL,
FR_IVST_CORP_YN	VARCHAR(1)	DEFAULT NULL,
VENT_YN	VARCHAR(1)	DEFAULT NULL,
LIST_CD	VARCHAR(10)	DEFAULT NULL,
IND_CD_ORDR	INT(5)	DEFAULT NULL,
IND_CD1	VARCHAR(6)	DEFAULT NULL,
IND_CD2	VARCHAR(6)	DEFAULT NULL,
IND_CD3	VARCHAR(6)	DEFAULT NULL,
PB_ORG_TYP	VARCHAR(3)	DEFAULT NULL,
MDSCO_PRTC_YN	VARCHAR(1)	DEFAULT NULL,
HDOF_CMP_CD	INT(10)	DEFAULT NULL,
ESTB_DATE	VARCHAR(8)	DEFAULT NULL,
ESTB_GB	VARCHAR(3)	DEFAULT NULL,
LIST_DATE	VARCHAR(8)	DEFAULT NULL,
MN_BIZ_CONT	VARCHAR(256)	DEFAULT NULL,
NATN_NM	VARCHAR(64)	DEFAULT NULL,
HOMEPAGE_URL	VARCHAR(128)	DEFAULT NULL,
CEO_NM	VARCHAR(128)	DEFAULT NULL,
EMP_CNT	INT(10)	DEFAULT NULL
);		
		
load data local infile '/Users/minkyoung/Documents/data/numble/BigActive_infor.csv' 		
into table numble.BIgActive_infor 		
CHARACTER SET 'utf8'		
FIELDS 		
	TERMINATED BY ','	
	IGNORE 1 LINES;	
    
    
